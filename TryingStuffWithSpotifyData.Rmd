---
title: "TryingStuffWithSpotifyData"
author: "Gabe Cederberg"
date: "2/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(janitor)
library(tidyverse)
library(lubridate)
```

```{r, echo = FALSE, message = FALSE}

# Loading Data

x <- read_csv("SpotifyDataForR5.csv",
  col_types = cols(
    Date = col_date(format = "%m/%d/%y"))) %>% 
  clean_names() %>% 
  select(date,
         artist, 
         title = "song_title",
         mins = "minutes_listened",
         time = "timeof_day",
         weekday = "dayofthe_week",
         month) %>% 
  separate(artist, "artist",",")
         
options(scipen = 999)


# Most listened to songs by an artist

x %>% 
  filter(artist == "Men At Work") %>% 
  group_by(title) %>% 
  summarize(total_listening = sum(mins)) %>% 
  arrange(desc(total_listening))


# Most listened to artists

x %>% group_by(artist) %>% 
  summarize(total_mins = sum(mins)) %>% 
  arrange(desc(total_mins))



# Compare listening trends among artists

a <- x %>% 
  filter(artist == "Drake" |
           artist == "Sam Cooke" |
           artist == "Post Malone" |
           artist == "Tyga" |
           artist == "G-Eazy" |
           artist == "Young Thug" |
           artist == "YNW Melly" |
           artist == "The Weeknd") %>% 
  group_by(artist, date) %>% 
  summarize(totalmins = sum(mins))

ggplot(a, aes(date, color = artist)) +
      geom_density() 


#a <- x %>% 
#    with_tz(TimeofDay, "America/New_York")
```


```{r}
#Trying to Visualize Minutes Listened by Time of Day



```


```{r}
#Trying to Visualize Minutes Listened by Time of Day, filtering for just EST
z <- x %>% 
  group_by(TimeofDay) %>% 
  filter(Date >= "2019-09-01" & Date <= "2019-12-01") %>% 
  mutate(totalMinutesFilter = sum(MinutesListened))

z

ggplot(z, aes(TimeofDay, totalMinutesFilter)) + geom_col()
```


```{r}
#Trying to Visualize Minutes Listened by Day of the Year
d <- x %>% 
  group_by(Date) %>% 
  mutate(DayMinutes = sum(MinutesListened))

d

ggplot(d, aes(Date, DayMinutes, color = Month)) + geom_col(width = 10)
```


```{r}
drake_cum <- x %>% 
  filter(Artist == "Travis Scott," |
           Artist == "Tyga," |
           Artist == "G-Eazy,") %>% 
#  mutate(total = cumsum(MinutesListened)) %>%
    group_by(Date, Artist) %>%
  summarize(total_day = sum(MinutesListened))
  
  
ggplot(drake_cum, aes(Date, total_day, color = Artist)) +
  geom_col(position = "dodge") +
  theme_classic()
```

