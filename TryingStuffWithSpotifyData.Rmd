---
title: "TryingStuffWithSpotifyData"
author: "Gabe Cederberg"
date: "2/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(janitor)
library(tidyverse)
library(lubridate)
options(scipen = 999)
```

```{r, echo = FALSE, message = FALSE}

# Loading Data

x <- read_csv("SpotifyData.csv",
  col_types = cols(
    Date = col_date(format = "%m/%d/%y"))) %>% 
  clean_names() %>% 
  select(date,
         artist, 
         title = "song_title",
         mins = "minutes_listened",
         time = "timeof_day",
         weekday = "dayofthe_week",
         month) %>% 
  separate(artist, "artist",",")


# Most listened to songs by an artist

x %>% 
  filter(artist == "Drake") %>% 
  group_by(title) %>% 
  summarize(total_listening = sum(mins)) %>% 
  arrange(desc(total_listening))


# Most listened to artists

x %>% group_by(artist) %>% 
  summarize(total_mins = sum(mins)) %>% 
  arrange(desc(total_mins))



# Compare listening trends among artists

a <- x %>% 
  filter(artist == "Drake" |
           artist == "Sam Cooke" |
           artist == "Post Malone" |
           artist == "Tyga" |
           artist == "G-Eazy" |
           artist == "Young Thug" |
           artist == "YNW Melly" |
           artist == "The Weeknd") %>% 
  group_by(artist, date) %>% 
  summarize(totalmins = sum(mins))

ggplot(a, aes(date, color = artist)) +
      geom_density() 


#a <- x %>% 
#    with_tz(TimeofDay, "America/New_York")
```


```{r}
#Trying to Visualize Minutes Listened by Time of Day

daytime <- x %>% group_by(time) %>% 
  filter(date > "2019-10-01" &
           date < "2019-11-01") %>% 
  summarize(total = sum(mins)) %>% 
  separate(time, c("hour", "minute", "second")) %>% 
  group_by(hour)


ggplot(daytime, aes(hour, total)) +
  geom_col()

```

```{r}
# Minutes listened to an artist by day of the week

drake_days <- x %>% 
  filter(artist == "Sergei Rachmaninoff") %>% 
  group_by(weekday) %>% 
  summarize(total_mins = sum(mins))

ggplot(drake_days, aes(weekday, total_mins)) +
  geom_col()
```



```{r}
#Trying to Visualize Minutes Listened by Time of Day, filtering for just EST
# z <- x %>% 
#   group_by(TimeofDay) %>% 
#   filter(Date >= "2019-09-01" & Date <= "2019-12-01") %>% 
#   mutate(totalMinutesFilter = sum(MinutesListened))
# 
# z
# 
# ggplot(z, aes(TimeofDay, totalMinutesFilter)) + geom_col()
```

